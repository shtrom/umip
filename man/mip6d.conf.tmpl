.\" $Id: mip6d.conf.tmpl 1.16 05/11/09 15:59:21+02:00 vnuorval@tcs.hut.fi $
.TH mip6d.conf 5 "May 16, 2005" "" "Mobile IPv6 Daemon Configuration"
.SH NAME
mip6d.conf \- MIPL Mobile IPv6 Configuration file
.SH SYNOPSIS
.B %etc%/mip6d.conf
.sp
.SH DESCRIPTION
MIPL Mobile IPv6 daemon's configuration file
.P
Below is a list of currently supported configuration options. All
configuration lines are terminated with a semicolon.  Sub-sections are
enclosed in '{' and '}'.  Strings are quoted with double quotes.

.SH COMMON OPTIONS

The file contains the following common definitions:
.TP
.BR "NodeConfig " "CN | HA | MN" ";"

Indicates if the daemon should run in Correspondent Node, Home Agent or
Mobile Node mode.

Default: CN

.TP
.BR "DebugLevel "  number ";"

Indicates the debug level of the daemon.  If the value is greater than
zero, the daemon will not detach from tty (i.e. debug messages will be
printed on the controlling tty).

Default: 0

.TP
.BR "DoRouteOptimizationCN " "boolean" ";"

Indicates if a node should participate in route optimization with a
Mobile Node.

Default: enabled

.TP
.BR "NonVolatileBindingCache " "boolean" ";"

This option is currently ignored.  Binding cache is always stored in
volatile memory, and is not retained between shutdown and startup.

.SH OPTIONS COMMON TO HOME AGENT AND MOBILE NODE

.TP
These options are used both in the Home Agent and Mobile Node:
.TP
.BR "Interface " "name" ";"
.TP
.nf
.BR "Interface " "name" " {"
.BR "	MnIfPreference " "number" ";"
.BR "	IsRouter " "boolean" ";"
.BR "	IfType " "CN | HA | MN" ";"
.B }
.fi

Specifies an interface and options associated with it.  If no options
are present, 
.B Interface
can be terminated with semi-colon.  This is used for home agent to
specify which interfaces are used for HA operation.  For the home
agent to function properly, a Router Advertisement daemon (e.g. radvd)
must broadcast advertisements with the Home Agent bit and Home Agent
Information Option set on these interfaces.  This option is also
used by multihomed Mobile Nodes to define which interfaces are used by it.

Only option
.B MnIfPreference
is used with Mobile IPv6.  It sets interface preference value for an
interface, in a multi-homed mobile node.  Preference is relative only
to other preference values, and may be a signed number.

.B IsRouter
and
.B IfType
are only used with NEMO.

.TP
.BR "UseMnHaIPsec " "boolean" ";"

Indicates if the MN-HA MIPv6 signalling should be protected with IPsec.

Default: enabled

.TP
.BR "KeyMngMobCapability " "boolean" ";"

If dynamic keying with MIPv6-aware IKE is used, this options should be
enabled.  It turns on the K-bit for binding updates and binding
acknowledgements.

Default: disabled

.TP
.nf
.BR "IPsecPolicySet {"
.BR "	HomeAgentAddress " "address" ";"
.BR "	HomeAddress " "address/length" ";"
.BR "	IPsecPolicy ..."
.BR "	...
.BR "}"
.fi

.B IPsecPolicySet
is a set of policies to apply for matching packets.  A policy set can
contain multiple
.B HomeAddress
options, but only one
.B HomeAgentAddress
option.  For home agent, home agent address field contains its own
address, and home address fields may contain any number of mobile
nodes for which the same policy applies.

.B IPsecPolicy
has the following format:

.TP
.BR "IPsecPolicy " "type " "UseESP UseAH UseIPComp;"

Field 
.B type 
can be one of HomeRegBinding, Mh, MobPfxDisc, ICMP, any, TunnelMh,
TunnelHomeTesting, or TunnelPayload.  At least one of the IPsec
protocols must be specified.  The any option protects all transport
mode communication between the MN and HA. Tunnel protection only
allows exactly one protocol.  Set IPsec protocol X with the "UseX"
flag.  Although not required, one can specify explicitly "NoX"
(e.g. UseESP NoAH NoIPComp).

.SH HOME AGENT SPECIFIC OPTIONS

The following definitions are ignored unless the node is configured as a HA:

.TP
.BR "SendMobPfxAdvs " "boolean" ";"

Controls whether home agent sends Mobile Prefix Advertisements to
mobile nodes in foreign networks.

.TP
.BR "SendUnsolMobPfxAdvs " "boolean" ";"

Controls whether home agent send unsolicited Mobile Prefix
Advertisements to mobile nodes in foreign networks.

.TP
.BR "MinMobPfxAdvInterval " "number" ";"

Sets a minimum interval (in seconds) for Mobile Prefix Advertisements.

Default: 600

.TP
.BR "MaxMobPfxAdvInterval " "number" ";"

Sets a maximum interval (in seconds) for Mobile Prefix Advertisements.

Default: 86400

.SH MOBILE NODE SPECIFIC OPTIONS

The following definitions are ignored unless the node is configured as a MN:

.TP
.BR "SendMobPfxSols " "boolean" ";"

Controls whether mobile node sends Mobile Prefix Solicitations to the
home network.

.TP
.BR "DoRouteOptimizationMN " "boolean" ";"

Indicates if the Mobile Node should initialize route optimization with
Corresponent Nodes.

Default: enabled

.TP
.BR "UseCnBuAck " "boolean" ";"

Indicates if the Acknowledge bit should be set in Binding Updates sent to
Corresponent Nodes.

Default: disabled

.TP
.BR "MnRouterProbesRA " "number" ";"

Indicates how many times the MN should send Neighbor Unreachability
Detection probes to its old router after receiving a Router
Advertisement from a new one.  If the option is set to zero, the MN
will move to the new router straight away.

Default: 0

.TP
.BR "MnRouterProbesLinkUp " "number" ";"

Indicates how many times the MN should send Neighbor Unreachability
Detection probes to its old router before initiating router discovery
when the link goes up after being down.

Default: 0

.TP
.BR "MnRouterProbeTimeout " "decimal" ";"

Indicates how long (in seconds) the MN should wait for a reply during
a access router Neighbor Unreachability Detection probe. If this
parameter isn't set, the Retransmit Timer value for the last link is
used. The Retransmit Timer is typically defined as one second. If the
parameter is set, the MN will use the minimum of MnRouterProbeTimeout
and Retransmit Timer, thus allowing faster handoffs.

Default: 0

.TP
.nf
.BR "MnHomeLink " "name " "{"
.BR "	HomeAddress " "address/length" ";"
.BR "	HomeAgentAddress " "address" ";"
.BR "	MnRoPolicy ..."
.BR "	..."
.BR "}"
.fi

Each 
.B MnHomeLink 
definition has a name.  This is the name (enclosed in double quotes)
of the interface used for connecting to the physical home link.  To
set up multiple Home Addresses on the Mobile Node, you need to define
multiple
.B MnHomeLink
structures.  The interface names don't have to be unique in these
definitions.  All the home link specific definitions are detailed below: 

.TP
.BR "HomeAddress " "address/length" ";"

Address is an IPv6 address, and length the prefix length of the
address, usually 64.  This option must be included in a home link
definition.

.TP
.BR "HomeAgentAddress " "address" ";"

Address is the IPv6 address of the Mobile Node's Home Agent. DHAAD is used
if it is the unspecified address ::.

Default: ::

.TP
The route optimization policies are of the form:

.TP
.BR "MnRoPolicy " "address boolean" ";"

Any number of these policies may be defined. If no policies are defined default
behavior depends on the
.B DoRouteOptimizationMN
option.

The fields for a route optimization policy entry are as follows: 
.B address
defines the Correspondent Node this policy applies to, if left
undefined the uspecified address is used as a wildcard value 
.B boolean
sets route optimization either enabled or disabled for packets
matching this entry.

.SH EXAMPLES

.TP
.BR "A Correspondent Node example:"

NodeConfig CN;

DoRouteOptimizationCN enabled;

.TP
.BR "A Home Agent example:"

.nf
NodeConfig HA;

Interface "eth0";
Interface "eth1";

UseMnHaIPsec enabled;

IPsecPolicySet {
        HomeAgentAddress 3ffe:2620:6:1::1;

        HomeAddress 3ffe:2620:6:1::1234/64;
        HomeAddress 3ffe:2620:6:1::1235/64;

        IPsecPolicy HomeRegBinding UseESP;
        IPsecPolicy TunnelMh UseESP;
}
.fi

.TP
.BR "A Mobile Node example:"

NodeConfig MN;

DoRouteOptimizationCN enabled;

DoRouteOptimizationMN enabled;

UseCnBuAck enabled;

.nf

MnHomeLink "eth0" {
        HomeAgentAddress 3ffe:2620:6:1::1;
        HomeAddress 3ffe:2620:6:1::1234/64;

        #               proto   type    code    route opt.
        MnRoPolicy      ICMP    any     any     disabled;
        MnRoPolicy      ICMP    129     0       enabled;
        #               proto   dst     src     route opt.
        MnRoPolicy      TCP     any     any     disabled;
        MnRoPolicy      TCP     80      any     enabled;
}
.fi

UseMnHaIPsec enabled;

.nf
IPsecPolicySet {
        HomeAgentAddress 3ffe:2620:6:1::1;
        HomeAddress 3ffe:2620:6:1::1234/64;

        IPsecPolicy HomeRegBinding UseESP;
        IPsecPolicy TunnelMh UseESP;
}
.fi

.SH SEE ALSO
.BR mip6d (1),
.BR mipv6 (7),
.PP
RFC3775: Mobility Support in IPv6,
.PP
RFC3776: Using IPsec to Protect Mobile IPv6 Signaling Between Mobile
Nodes and Home Agents
